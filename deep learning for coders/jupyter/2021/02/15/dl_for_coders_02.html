<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Deep Learning for Coders - Chapter 2 [Draft] | My Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Deep Learning for Coders - Chapter 2 [Draft]" />
<meta name="author" content="Nathaniel D'Amours" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An even more top-down approach of the chapter" />
<meta property="og:description" content="An even more top-down approach of the chapter" />
<link rel="canonical" href="https://nathanieldamours.github.io/blog/deep%20learning%20for%20coders/jupyter/2021/02/15/dl_for_coders_02.html" />
<meta property="og:url" content="https://nathanieldamours.github.io/blog/deep%20learning%20for%20coders/jupyter/2021/02/15/dl_for_coders_02.html" />
<meta property="og:site_name" content="My Blog" />
<meta property="og:image" content="https://nathanieldamours.github.io/blog/images/bear_example.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-02-15T00:00:00-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://nathanieldamours.github.io/blog/images/bear_example.jpg" />
<meta property="twitter:title" content="Deep Learning for Coders - Chapter 2 [Draft]" />
<script type="application/ld+json">
{"description":"An even more top-down approach of the chapter","mainEntityOfPage":{"@type":"WebPage","@id":"https://nathanieldamours.github.io/blog/deep%20learning%20for%20coders/jupyter/2021/02/15/dl_for_coders_02.html"},"url":"https://nathanieldamours.github.io/blog/deep%20learning%20for%20coders/jupyter/2021/02/15/dl_for_coders_02.html","@type":"BlogPosting","image":"https://nathanieldamours.github.io/blog/images/bear_example.jpg","author":{"@type":"Person","name":"Nathaniel D'Amours"},"headline":"Deep Learning for Coders - Chapter 2 [Draft]","dateModified":"2021-02-15T00:00:00-06:00","datePublished":"2021-02-15T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nathanieldamours.github.io/blog/feed.xml" title="My Blog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">My Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Deep Learning for Coders - Chapter 2 [Draft]</h1><p class="page-description">An even more top-down approach of the chapter</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-02-15T00:00:00-06:00" itemprop="datePublished">
        Feb 15, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Nathaniel D'Amours</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Deep Learning for Coders">Deep Learning for Coders</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Jupyter">Jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/NathanielDamours/blog/tree/master/_notebooks/2021-02-15-dl_for_coders_02.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/NathanielDamours/blog/master?filepath=_notebooks%2F2021-02-15-dl_for_coders_02.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/NathanielDamours/blog/blob/master/_notebooks/2021-02-15-dl_for_coders_02.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FNathanielDamours%2Fblog%2Fblob%2Fmaster%2F_notebooks%2F2021-02-15-dl_for_coders_02.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#From-Model-to-Production">From Model to Production </a>
<ul>
<li class="toc-entry toc-h2"><a href="#The-Practice-of-Deep-Learning">The Practice of Deep Learning </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Starting-Your-Project">Starting Your Project </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Gathering-Data">Gathering Data </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Sidebar:-Getting-Help-in-Jupyter-Notebooks">Sidebar: Getting Help in Jupyter Notebooks </a></li>
<li class="toc-entry toc-h3"><a href="#End-sidebar">End sidebar </a></li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-02-15-dl_for_coders_02.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="From-Model-to-Production">
<a class="anchor" href="#From-Model-to-Production" aria-hidden="true"><span class="octicon octicon-link"></span></a>From Model to Production<a class="anchor-link" href="#From-Model-to-Production"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The six lines of code we saw in the last chapter are just one small part of the process of using deep learning in practice. In this chapter, we're going to use a computer vision example to look at the end-to-end process of creating a deep learning application. More specifically, we're going to build a bear classifier! In the process, we'll discuss the capabilities and constraints of deep learning, explore how to create datasets, look at possible gotchas when using deep learning in practice, and more. Many of the key points will apply equally well to other deep learning problems, such as those in last chapter. If you work through a problem similar in key respects to our example problems, we expect you to get excellent results with little code, quickly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Practice-of-Deep-Learning">
<a class="anchor" href="#The-Practice-of-Deep-Learning" aria-hidden="true"><span class="octicon octicon-link"></span></a>The Practice of Deep Learning<a class="anchor-link" href="#The-Practice-of-Deep-Learning"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've seen that deep learning can solve a lot of challenging problems quickly and with little code. However, deep learning isn't magic! The same 6 lines of code won't work for every problem anyone can think of today.</p>
<p>We often talk to people who underestimate both the constraints and the capabilities of deep learning. Both of these can be problems: underestimating the capabilities means that you might not even try things that could be very beneficial, and underestimating the constraints might mean that you fail to consider and react to important issues.</p>
<p>The best thing to do is to keep an open mind. Then, it is possible to design a process where you can find the specific capabilities and constraints related to your particular problem as you work through the process. This doesn't mean making any risky bets — we will show you how you can gradually roll out models so that they don't create significant risks, and can even backtest them prior to putting them in production.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Starting-Your-Project">
<a class="anchor" href="#Starting-Your-Project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Starting Your Project<a class="anchor-link" href="#Starting-Your-Project"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When selecting a project, the most important consideration is data availability. However, the goal is not to find the "perfect" dataset or project, but just to get started and iterate from there.</p>
<p>We also suggest that you iterate from end to end in your project; that is, don't spend months fine-tuning your model, or polishing the perfect GUI, or labelling the perfect dataset… Instead, complete every step as well as you can in a reasonable amount of time, all the way to the end. By completing the project end to end, you will see where the trickiest bits are, and which bits make the biggest difference to the final result.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you work through this book, we suggest that you complete lots of small experiments, by running and adjusting the notebooks we provide, at the same time that you gradually develop your own projects. That way, you will be getting experience with all of the tools and techniques that we're explaining, as we discuss them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-success">
    <svg class="octicon octicon-checklist" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M2.5 1.75a.25.25 0 01.25-.25h8.5a.25.25 0 01.25.25v7.736a.75.75 0 101.5 0V1.75A1.75 1.75 0 0011.25 0h-8.5A1.75 1.75 0 001 1.75v11.5c0 .966.784 1.75 1.75 1.75h3.17a.75.75 0 000-1.5H2.75a.25.25 0 01-.25-.25V1.75zM4.75 4a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-4.5zM4 7.75A.75.75 0 014.75 7h2a.75.75 0 010 1.5h-2A.75.75 0 014 7.75zm11.774 3.537a.75.75 0 00-1.048-1.074L10.7 14.145 9.281 12.72a.75.75 0 00-1.062 1.058l1.943 1.95a.75.75 0 001.055.008l4.557-4.45z"></path></svg>
    <strong>Tip: </strong>To make the most of this book, take the time to experiment between each chapter, be it on your own project or by exploring the notebooks we provide. Then try rewriting those notebooks from scratch on a new dataset. It’s only by practicing (and failing) a lot that you will get an intuition of how to train a model.  
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By using the end-to-end iteration approach you will also get a better understanding of how much data you really need. Indeed, for instance, you may find you can only easily get 200 labeled data items.</p>
<p>In an organizational context you will be able to show your colleagues that your idea can really work by showing them a real working prototype. We have repeatedly observed that this is the secret to getting good organizational buy-in for a project.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since it is easiest to get started on a project where you already have data available, that means it's probably easiest to get started on a project related to something you are already doing, because you already have data about things that you are doing. For instance, if you work in the music business, you may have access to many recordings.</p>
<p>Sometimes, you have to get a bit creative. Maybe you can find some previous machine learning project, such as a Kaggle competition, that is related to your field of interest.</p>
<p>Sometimes, you have to compromise. Maybe you can't find the exact data you need for the precise project you have in mind; but you might be able to find something from a similar domain, or measured in a different way, tackling a slightly different problem.</p>
<p>Especially when you are just starting out with deep learning, it's not a good idea apply deep learning where it has not been before. That's because if your model does not work at first, you will not know whether it is because you have made a mistake, or if the very problem you are trying to solve is simply not solvable with deep learning. Let's have a look at the state of deep learning, just so you know what kinds of things deep learning is good at right now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gathering-Data">
<a class="anchor" href="#Gathering-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gathering Data<a class="anchor-link" href="#Gathering-Data"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The project we'll be completing in this chapter is a <em>bear detector</em>. It will discriminate between three types of bear: grizzly, black, and teddy bears. You can follow along with this chapter and create your own image recognition application for whatever kinds of objects you're interested in. In the fast.ai course, thousands of students have presented their work in the course forums, displaying everything from hummingbird varieties in Trinidad to bus types in Panama—one student even created an application that would help his fiancée recognize his 16 cousins during Christmas vacation!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For many types of projects, you may be able to find all the data you need online. At the time of writing, the Bing image downloader from <a href="https://github.com/gurugaurav/bing_image_downloader">this repository</a> is probably the best option for finding and downloading images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash">
    <svg class="octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>The Bing image downloader allows you to start quickly your DL project and iterate from there. However, you might encounter some issues with it such as a lot of duplicate images. Therefore, in your second iteration, during the creation of your dataset, you might use the solution proposed in the <a href="https://github.com/fastai/fastbook/blob/master/02_production.ipynb">fastbook</a>.
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is the code to download our images :</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pip</span> install bing_image_downloader
<span class="kn">from</span> <span class="nn">bing_image_downloader</span> <span class="kn">import</span> <span class="n">downloader</span>


<span class="n">bear_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">'bears_dataset'</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">bear_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">bear_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

<span class="n">bear_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'grizzly bear'</span><span class="p">,</span><span class="s1">'black bear'</span><span class="p">,</span><span class="s1">'teddy bear'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">bear_type</span> <span class="ow">in</span> <span class="n">bear_types</span><span class="p">:</span>
    <span class="n">downloader</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">bear_type</span><span class="p">,</span>
                        <span class="n">limit</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                        <span class="n">output_dir</span><span class="o">=</span><span class="n">bear_path</span><span class="p">)</span>

<span class="n">image_files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">bear_path</span><span class="p">)</span>
<span class="n">failed_images</span> <span class="o">=</span> <span class="n">verify_images</span><span class="p">(</span><span class="n">image_files</span><span class="p">)</span>
<span class="n">failed_images</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">unlink</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image_files</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#450) [Path('bears_dataset/black bear/Image_1.jpg'),Path('bears_dataset/black bear/Image_10.jpg'),Path('bears_dataset/black bear/Image_100.jpg'),Path('bears_dataset/black bear/Image_101.jpg'),Path('bears_dataset/black bear/Image_102.bmp'),Path('bears_dataset/black bear/Image_103.png'),Path('bears_dataset/black bear/Image_104.jpg'),Path('bears_dataset/black bear/Image_105.jpg'),Path('bears_dataset/black bear/Image_106.jpg'),Path('bears_dataset/black bear/Image_107.jpg')...]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our folder has image files, as we'd expect. Let's open one :</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bear_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">bear_img</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/bear_example.jpg" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's break down this code.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pip</span> install bing_image_downloader
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This line is used to download images with Bing Image Search, it's the same thing as doing <code>pip install bing_image_downloader</code> in your terminal.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">bing_image_downloader</span> <span class="kn">import</span> <span class="n">downloader</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we import the <code>downloader</code> from <code>bing_image_downloader</code> in order to use it to get the images from the web.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bear_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">'bears_dataset'</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">bear_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">bear_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This code creates a <code>Path</code> object and a directory from it if it didn't already exists.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bear_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'grizzly bear'</span><span class="p">,</span> <span class="s1">'black bear'</span><span class="p">,</span> <span class="s1">'teddy bear'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">bear_type</span> <span class="ow">in</span> <span class="n">bear_types</span><span class="p">:</span>
    <span class="n">downloader</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">bear_type</span><span class="p">,</span>
                        <span class="n">limit</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
                        <span class="n">output_dir</span><span class="o">=</span><span class="n">bear_type</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we iterate over the <code>bear_types</code> in order to download <code>150</code> images stored in the <code>bear_type</code> folder. We actually do a Bing research with your query and return the first results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's all the parameter of the <code>download</code> method :</p>
<ul>
<li>
<code>query</code>: String to be searched.</li>
<li>
<code>limit</code>: Number of images to download (optional, default is 100).</li>
<li>
<code>output_dir</code>: Name of output dir (optional, default is 'dataset').</li>
<li>
<code>adult_filter_off</code>: Enable of disable adult filteration (optional, default is True).</li>
<li>
<code>force_replace</code>: Delete folder if present and start a fresh download (optional, default is False).</li>
<li>
<code>timeout</code>: Timeout for connection in seconds (optional, default is 60).</li>
<li>
<code>filter</code>: Filter, choose from [line, photo, clipart, gif, transparent] (optional, default is "").</li>
<li>
<code>verbose</code>: Enable downloaded message (optional, default is True).</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image_files</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">bear_path</span><span class="p">)</span>
<span class="n">failed_images</span> <span class="o">=</span> <span class="n">verify_images</span><span class="p">(</span><span class="n">image_files</span><span class="p">)</span>
<span class="n">failed_images</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">unlink</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#0) []</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we download files from the internet, there are a few that are corrupt. To remove all the failed images, you can use <code>unlink</code> on each of them. In this case, no files were corrupted. Note that, like most fastai functions that return a collection, <code>verify_images</code> returns an object of type <code>L</code>, which includes the <code>map</code> method. This calls the passed function on each element of the collection.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sidebar:-Getting-Help-in-Jupyter-Notebooks">
<a class="anchor" href="#Sidebar:-Getting-Help-in-Jupyter-Notebooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sidebar: Getting Help in Jupyter Notebooks<a class="anchor-link" href="#Sidebar:-Getting-Help-in-Jupyter-Notebooks"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Jupyter notebooks are great for experimenting and immediately seeing the results of each function, but there is also a lot of functionality to help you figure out how to use different functions, or even directly look at their source code. Here are some other features that are very useful in Jupyter notebooks:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/jupyter_autocomplete.png" alt="" title="Jupyter's autocomplete"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At any point, if you don't remember the exact spelling of a function or argument name, you can press Tab to get autocompletion suggestions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/jupyter_shift_tab.png" alt="" title="Function's signature and short description"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When inside the parentheses of a function, pressing Shift and Tab simultaneously will display a window with the signature of the function and a short description. Pressing these keys twice will expand the documentation, and pressing them three times will open a full window with the same information at the bottom of your screen.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">?</span>verify_images
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-red-intense-fg ansi-bold">Signature:</span> verify_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>fns<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">Docstring:</span> Find images in `fns` that can't be opened
<span class="ansi-red-intense-fg ansi-bold">File:</span>      c:\users\natha\anaconda3\envs\fastbook\lib\site-packages\fastai\vision\utils.py
<span class="ansi-red-intense-fg ansi-bold">Type:</span>      function
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- ![](my_icons/dl_for_coders_02/jupyter_question_mark.png "Function's signature and short description") -->
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a cell, typing <code>?function_name</code> and executing will show the signature of the function and a short description.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- ![](my_icons/dl_for_coders_02/jupyter_double_question_mark.png "Function's signature, short description and source code") -->
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">??</span>verify_images
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-red-intense-fg ansi-bold">Signature:</span> verify_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>fns<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">Source:</span>   
<span class="ansi-green-intense-fg ansi-bold">def</span> verify_images<span class="ansi-yellow-intense-fg ansi-bold">(</span>fns<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">:</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>    <span class="ansi-blue-intense-fg ansi-bold">"Find images in `fns` that can't be opened"</span><span class="ansi-yellow-intense-fg ansi-bold">
</span>    <span class="ansi-green-intense-fg ansi-bold">return</span> L<span class="ansi-yellow-intense-fg ansi-bold">(</span>fns<span class="ansi-yellow-intense-fg ansi-bold">[</span>i<span class="ansi-yellow-intense-fg ansi-bold">]</span> <span class="ansi-green-intense-fg ansi-bold">for</span> i<span class="ansi-yellow-intense-fg ansi-bold">,</span>o <span class="ansi-green-intense-fg ansi-bold">in</span> enumerate<span class="ansi-yellow-intense-fg ansi-bold">(</span>parallel<span class="ansi-yellow-intense-fg ansi-bold">(</span>verify_image<span class="ansi-yellow-intense-fg ansi-bold">,</span> fns<span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">)</span> <span class="ansi-green-intense-fg ansi-bold">if</span> <span class="ansi-green-intense-fg ansi-bold">not</span> o<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">File:</span>      c:\users\natha\anaconda3\envs\fastbook\lib\site-packages\fastai\vision\utils.py
<span class="ansi-red-intense-fg ansi-bold">Type:</span>      function
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a cell, typing <code>??function_name</code> and executing will show the signature of the function, a short description, and the source code.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/fastai_doc.png" alt="" title="Function's signature, short description and source code"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you are using the fastai library, we added a <code>doc</code> function for you: executing <code>doc(function_name)</code> in a cell will open a window with the signature of the function, a short description and links to the source code on GitHub and the full documentation of the function in the <a href="https://docs.fast.ai">library docs</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/jupyter_debug_short.png" alt="" title="%debug magic method"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get help at any point if you get an error, type <code>%debug</code> in the next cell and execute to open the <a href="https://docs.python.org/3/library/pdb.html">Python debugger</a>, which will let you inspect the content of every variable and test expressions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="End-sidebar">
<a class="anchor" href="#End-sidebar" aria-hidden="true"><span class="octicon octicon-link"></span></a>End sidebar<a class="anchor-link" href="#End-sidebar"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One thing to be aware of in this process: as we discussed in the last chapter, models can only reflect the data used to train them. And the world is full of biased data, which ends up reflected in, for example, Bing Image Search. For instance, let's say you were interested in creating an app that could help users figure out whether they had healthy skin, so you trained a model on the results of searches for "healthy skin". Here's the kinds of results you would get :</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/dl_for_coders_02/healthy_skin.gif" alt="" title="Data for a healthy skin detector?"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With this as your training data, you would end up not with a healthy skin detector, but a <em>young white woman touching her face</em> detector! Be sure to think carefully about the types of data that you might expect to see in practice in your application, and check carefully to ensure that all these types are reflected in your model's source data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have downloaded some data, we need to assemble it in a format suitable for model training. In fastai, that means creating an object called <code>DataLoaders</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post is highly inspired from <em>Deep Learning for Coders</em> <a class="citation" href="#howard2020deep">[1]</a>.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="NathanielDamours/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/deep%20learning%20for%20coders/jupyter/2021/02/15/dl_for_coders_02.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Right now, this blog is a summary of the Deep Learning for Coders with Fastai and PyTorch.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/NathanielDamours" target="_blank" title="NathanielDamours"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
